<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Timeshare Calculator</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body style="margin:0;padding:0;">
  <div id="root"></div>
  <script type="text/babel">

const Printer = ({ size = 24 }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
    <polyline points="6 9 6 2 18 2 18 9"></polyline>
    <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
    <rect x="6" y="14" width="12" height="8"></rect>
  </svg>
);
const ChevronRight = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"></polyline></svg>;
const ChevronLeft = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="15 18 9 12 15 6"></polyline></svg>;
const Check = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="20 6 9 17 4 12"></polyline></svg>;
const Edit2 = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>;
const User = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>;
const Building2 = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>;
const DollarSign = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>;
const TrendingUp = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>;
const Download = ({ size = 24 }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;

const { useState } = React;

function TimeshareCalculator() {
  const [step, setStep] = useState(1);
  const [formData, setFormData] = useState({
    // Owner Information
    owner1Name: '',
    owner2Name: '',
    owner3Name: '',
    owner4Name: '',
    homeAddress: '',
    city: '',
    state: '',
    zip: '',
    homePhone: '',
    mobilePhone1: '',
    mobilePhone2: '',
    email1: '',
    email2: '',
    
    // Mortgage
    mortgage: 0,
    
    // Resorts (up to 4)
    resorts: [
      { 
        name: '', 
        address: '', 
        city: '', 
        state: '', 
        zip: '',
        maintenanceFee: 0, 
        inflationRate: 8.3,
        ownershipType: '',
        weekNumber: '',
        active: true 
      },
      { 
        name: '', 
        address: '', 
        city: '', 
        state: '', 
        zip: '',
        maintenanceFee: 0, 
        inflationRate: 6.7,
        ownershipType: '',
        weekNumber: '',
        active: false 
      },
      { 
        name: '', 
        address: '', 
        city: '', 
        state: '', 
        zip: '',
        maintenanceFee: 0, 
        inflationRate: 6.7,
        ownershipType: '',
        weekNumber: '',
        active: false 
      },
      { 
        name: '', 
        address: '', 
        city: '', 
        state: '', 
        zip: '',
        maintenanceFee: 0, 
        inflationRate: 6.7,
        ownershipType: '',
        weekNumber: '',
        active: false 
      },
    ],
    
    // Drop Sheet Defaults (editable)
    transferFees: 1800,
    processingFee: 449,
    mra: 12500,
  });
  
  const [dropSheetData, setDropSheetData] = useState([]);
  const [editingDropSheet, setEditingDropSheet] = useState(null);

  // Format number with commas
  const formatCurrency = (num) => {
    return num.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  };

  // Calculate 30-year projections for a resort
  const calculateProjections = (maintenanceFee, inflationRate) => {
    const rate = inflationRate / 100;
    const years = [];
    let cumulative = 0;
    
    for (let year = 1; year <= 30; year++) {
      const annualCost = maintenanceFee * Math.pow(1 + rate, year);
      cumulative += annualCost;
      years.push({
        year,
        annualCost,
        cumulative
      });
    }
    
    return {
      years,
      totalInflation: cumulative,
      year30Cost: years[29].annualCost
    };
  };

  // Generate drop sheet data when moving to calculations
  const generateDropSheets = () => {
    const sheets = formData.resorts
      .filter(resort => resort.active && resort.maintenanceFee > 0)
      .map((resort, index) => {
        const projections = calculateProjections(resort.maintenanceFee, resort.inflationRate);
        
        // Get 20-year cumulative cost (year 20 is at index 19)
        const year20Cumulative = projections.years[19].cumulative;
        
        // Calculate Gross Liquidation Price = 20-year cumulative + transfer + processing
        const grossLiquidation = year20Cumulative + formData.transferFees + formData.processingFee;
        
        // Calculate EBOC = Gross Liquidation - MRA
        const eboc = grossLiquidation - formData.mra;
        
        return {
          resortIndex: index,
          resortName: resort.name,
          owner: formData.owner1Name,
          address: formData.homeAddress,
          phone: formData.mobilePhone1 || formData.homePhone,
          inflationRate: resort.inflationRate,
          currentMaintFee: resort.maintenanceFee,
          maintFeeInflation: projections.totalInflation,
          year20Cumulative: year20Cumulative,
          mortgage: formData.mortgage,
          totalCost: resort.maintenanceFee + projections.totalInflation + formData.mortgage,
          transferFees: formData.transferFees,
          processingFee: formData.processingFee,
          mra: formData.mra,
          grossLiquidation: grossLiquidation,
          eboc: eboc,
          projections: projections.years
        };
      });
    
    setDropSheetData(sheets);
  };

  const handleInputChange = (field, value) => {
    setFormData(prev => ({
      ...prev,
      [field]: value
    }));
  };

  const handleResortChange = (index, field, value) => {
    setFormData(prev => ({
      ...prev,
      resorts: prev.resorts.map((resort, i) => 
        i === index ? { ...resort, [field]: value } : resort
      )
    }));
  };

  const handleDropSheetEdit = (sheetIndex, field, value) => {
    setDropSheetData(prev => prev.map((sheet, i) => {
      if (i === sheetIndex) {
        const updated = { ...sheet, [field]: parseFloat(value) || 0 };
        
        // Recalculate dependent values
        if (['transferFees', 'processingFee', 'mra'].includes(field)) {
          // Gross Liquidation = 20-year cumulative + transfer fees + processing fee
          updated.grossLiquidation = updated.year20Cumulative + updated.transferFees + updated.processingFee;
          // EBOC = Gross Liquidation - MRA
          updated.eboc = updated.grossLiquidation - updated.mra;
        }
        
        return updated;
      }
      return sheet;
    }));
  };

  const goToDropSheets = () => {
    generateDropSheets();
    setStep(2); // Changed from setStep(2) to go straight to drop sheets
  };

  const printDropSheet = (sheetIndex) => {
    // Add a small delay to ensure rendering is complete
    setTimeout(() => {
      window.print();
    }, 100);
  };

  const downloadDropSheet = async (sheetIndex) => {
    try {
      const element = document.getElementById(`drop-sheet-${sheetIndex}`);
      const resortName = dropSheetData[sheetIndex].resortName.replace(/\s+/g, '-');
      
      // Use html2canvas and jsPDF
      if (window.html2canvas && window.jspdf) {
        const { jsPDF } = window.jspdf;
        
        // Get all print-page elements within the drop sheet
        const pages = element.querySelectorAll('.print-page');
        const pdf = new jsPDF('p', 'pt', 'letter');
        
        for (let i = 0; i < pages.length; i++) {
          const canvas = await window.html2canvas(pages[i], {
            scale: 2,
            useCORS: true,
            logging: false,
            backgroundColor: '#ffffff'
          });
          
          const imgData = canvas.toDataURL('image/jpeg', 0.95);
          const imgWidth = 612; // Letter width in points
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          
          if (i > 0) {
            pdf.addPage();
          }
          
          pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
        }
        
        pdf.save(`${resortName}-Drop-Sheet.pdf`);
      } else {
        alert('PDF libraries not loaded. Please use the Print button and choose "Save as PDF".');
      }
    } catch (error) {
      console.error('PDF generation error:', error);
      alert('Failed to generate PDF. Please use the Print button and choose "Save as PDF".');
    }
  };

  const activeResorts = formData.resorts.filter(r => r.active);
  const totalAnnualMaint = activeResorts.reduce((sum, r) => sum + (parseFloat(r.maintenanceFee) || 0), 0);

  return (
    <div style={{
      minHeight: '100vh',
      background: '#000000',
      margin: 0,
      padding: 0
    }}>
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        
        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
          -webkit-font-smoothing: antialiased;
        }
        
        .glass-card {
          background: #0a0a0a;
          border-radius: 16px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
          border: 1px solid #1a1a1a;
        }
        
        .input-field {
          background: #000000;
          border: 2px solid #1a1a1a;
          border-radius: 12px;
          padding: 14px 16px;
          color: #e2e8f0;
          width: 100%;
          font-size: 15px;
          transition: all 0.2s ease;
          font-weight: 500;
        }
        
        .input-field:focus {
          outline: none;
          background: #0a0a0a;
          border-color: #7c3aed;
          box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1);
        }
        
        .input-field::placeholder {
          color: #64748b;
          font-weight: 400;
        }
        
        .btn-primary {
          background: linear-gradient(135deg, #7c3aed 0%, #60a5fa 100%);
          color: white;
          padding: 16px 32px;
          border-radius: 16px;
          border: none;
          font-weight: 700;
          font-size: 15px;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 16px rgba(124, 58, 237, 0.3);
          letter-spacing: 0.3px;
        }
        
        .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 24px rgba(124, 58, 237, 0.4);
        }
        
        .btn-primary:active {
          transform: translateY(0);
        }
        
        .btn-secondary {
          background: #0a0a0a;
          color: #e2e8f0;
          padding: 14px 28px;
          border-radius: 14px;
          border: 2px solid #1a1a1a;
          font-weight: 600;
          font-size: 15px;
          cursor: pointer;
          transition: all 0.2s ease;
        }
        
        .btn-secondary:hover {
          background: #1a1a1a;
          border-color: #7c3aed;
        }
        
        .section-card {
          background: #0a0a0a;
          border-radius: 20px;
          padding: 28px;
          margin-bottom: 20px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
          transition: all 0.3s ease;
          border: 1px solid #1a1a1a;
        }
        
        .section-card:hover {
          box-shadow: 0 4px 16px rgba(124, 58, 237, 0.2);
          border-color: #7c3aed;
        }
        
        .section-header {
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 24px;
          padding-bottom: 16px;
          border-bottom: 2px solid #7c3aed;
        }
        
        .section-title {
          font-size: 20px;
          font-weight: 700;
          color: #e2e8f0;
        }
        
        .icon-wrapper {
          width: 40px;
          height: 40px;
          border-radius: 12px;
          background: linear-gradient(135deg, #7c3aed 0%, #60a5fa 100%);
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
        }
        
        .resort-card {
          background: #000000;
          border-radius: 16px;
          padding: 24px;
          margin-bottom: 16px;
          border: 2px solid #1a1a1a;
          transition: all 0.3s ease;
        }
        
        .resort-card.inactive {
          opacity: 0.5;
        }
        
        .resort-card.active {
          border-color: #7c3aed;
          background: #0a0a0a;
          box-shadow: 0 0 20px rgba(124, 58, 237, 0.2);
        }
        
        .toggle-switch {
          position: relative;
          width: 56px;
          height: 32px;
          background: #1a1a1a;
          border-radius: 16px;
          cursor: pointer;
          transition: all 0.3s ease;
        }
        
        .toggle-switch.active {
          background: linear-gradient(135deg, #7c3aed 0%, #60a5fa 100%);
        }
        
        .toggle-slider {
          position: absolute;
          top: 4px;
          left: 4px;
          width: 24px;
          height: 24px;
          background: white;
          border-radius: 12px;
          transition: all 0.3s ease;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .toggle-switch.active .toggle-slider {
          left: 28px;
        }
        
        .label {
          font-size: 13px;
          font-weight: 600;
          color: #94a3b8;
          margin-bottom: 8px;
          display: block;
          letter-spacing: 0.3px;
        }
        
        .stat-card {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          border-radius: 16px;
          padding: 20px;
          color: white;
        }
        
        .stat-label {
          font-size: 13px;
          font-weight: 600;
          opacity: 0.9;
          margin-bottom: 8px;
          letter-spacing: 0.5px;
        }
        
        .stat-value {
          font-size: 28px;
          font-weight: 800;
          letter-spacing: -0.5px;
        }
        
        .step-indicator {
          background: #0a0a0a;
          border: 2px solid #1a1a1a;
          border-radius: 12px;
          padding: 8px 20px;
          font-size: 14px;
          font-weight: 600;
          color: #94a3b8;
          transition: all 0.3s ease;
        }
        
        .step-indicator.active {
          background: linear-gradient(135deg, #7c3aed 0%, #60a5fa 100%);
          color: white;
          border-color: transparent;
        }
        
        .calculation-table {
          width: 100%;
          border-collapse: collapse;
          margin: 20px 0;
        }
        
        .calculation-table th {
          background: #000000;
          padding: 14px 16px;
          text-align: left;
          font-weight: 700;
          color: #94a3b8;
          font-size: 13px;
          letter-spacing: 0.5px;
          text-transform: uppercase;
        }
        
        .calculation-table td {
          padding: 14px 16px;
          border-bottom: 1px solid #1a1a1a;
          color: #e2e8f0;
          font-weight: 500;
        }
        
        .calculation-table tr:hover {
          background: #0a0a0a;
        }
        
        .fade-in {
          animation: fadeIn 0.4s ease-out;
        }
        
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        .grid-2 {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
        }
        
        .grid-3 {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 16px;
        }
        
        @media (max-width: 768px) {
          .grid-2, .grid-3 {
            grid-template-columns: 1fr;
          }
        }
        
        /* PRINT STYLES - OPTIMIZED FOR MOBILE */
        @media print {
          * {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          @page {
            size: auto;
            margin: 0.4in 0.3in;
          }
          
          html, body {
            background: white !important;
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
          }
          
          body {
            font-size: 11px !important;
          }
          
          .no-print {
            display: none !important;
          }
          
          .print-page {
            page-break-after: always !important;
            page-break-inside: avoid !important;
            width: 100% !important;
            padding: 0 !important;
            margin: 0 !important;
          }
          
          .print-page:last-child {
            page-break-after: auto !important;
          }
          
          .avoid-break {
            page-break-inside: avoid !important;
            break-inside: avoid !important;
          }
          
          h1 {
            font-size: 16px !important;
            margin-bottom: 8px !important;
          }
          
          h2 {
            font-size: 14px !important;
            margin-bottom: 6px !important;
          }
          
          h3 {
            font-size: 12px !important;
            margin-bottom: 6px !important;
          }
          
          .print-header {
            border-bottom: 2px solid #000 !important;
            padding-bottom: 10px !important;
            margin-bottom: 15px !important;
          }
          
          .print-info-grid {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 6px !important;
            font-size: 10px !important;
            margin-bottom: 10px !important;
          }
          
          .comparison-grid {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 20px !important;
            margin-bottom: 15px !important;
          }
          
          .option-box {
            font-size: 10px !important;
            line-height: 1.4 !important;
            border-width: 2px !important;
          }
          
          .option-header {
            padding: 8px !important;
            margin-bottom: 8px !important;
            font-size: 11px !important;
          }
          
          .cost-box {
            padding: 10px !important;
            margin-top: 10px !important;
            font-size: 10px !important;
          }
          
          .cost-row {
            margin-bottom: 6px !important;
          }
          
          .cost-total {
            padding-top: 6px !important;
            margin-top: 6px !important;
            font-size: 11px !important;
          }
          
          table {
            page-break-inside: auto !important;
            font-size: 9px !important;
            margin: 10px 0 !important;
          }
          
          table th {
            padding: 6px 4px !important;
            font-size: 9px !important;
          }
          
          table td {
            padding: 5px 4px !important;
            font-size: 9px !important;
          }
          
          tr {
            page-break-inside: avoid !important;
            page-break-after: auto !important;
          }
          
          .signature-section {
            margin-top: 15px !important;
            padding: 12px !important;
            border: 2px solid #000 !important;
            font-size: 10px !important;
          }
          
          .signature-line {
            border-bottom: 1px solid #000 !important;
            margin-bottom: 3px !important;
          }
          
          input[type="number"] {
            border: none !important;
            background: transparent !important;
            font-weight: bold !important;
          }
        }
      `}</style>

      {/* Header */}
      <div className="no-print" style={{ 
        padding: '24px 0', 
        borderBottom: '2px solid #7c3aed',
        background: '#000000'
      }}>
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '0 24px' }}>
          <h1 style={{ 
            fontSize: '32px', 
            fontWeight: '800', 
            background: 'linear-gradient(135deg, #7c3aed 0%, #60a5fa 100%)',
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            backgroundClip: 'text',
            marginBottom: '20px',
            letterSpacing: '-0.5px'
          }}>
            Timeshare Calculator
          </h1>
          <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
            <div className={`step-indicator ${step === 1 ? 'active' : ''}`}>
              1. Input
            </div>
            <div className={`step-indicator ${step === 2 ? 'active' : ''}`}>
              2. Drop Sheets
            </div>
          </div>
        </div>
      </div>

      <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px 24px' }}>
        
        {/* STEP 1: Input Form */}
        {step === 1 && (
          <div className="fade-in">
            <div className="glass-card" style={{ padding: '32px', marginBottom: '24px' }}>
              
              {/* Owner Information */}
              <div className="section-card">
                <div className="section-header">
                  <div className="icon-wrapper">
                    <User size={20} />
                  </div>
                  <h2 className="section-title">Owner Information</h2>
                </div>
                <div className="grid-2">
                  <div>
                    <label className="label">Owner #1 Name *</label>
                    <input
                      type="text"
                      className="input-field"
                      value={formData.owner1Name}
                      onChange={(e) => handleInputChange('owner1Name', e.target.value)}
                      placeholder="Full Name"
                    />
                  </div>
                  <div>
                    <label className="label">Owner #2 Name</label>
                    <input
                      type="text"
                      className="input-field"
                      value={formData.owner2Name}
                      onChange={(e) => handleInputChange('owner2Name', e.target.value)}
                      placeholder="Full Name"
                    />
                  </div>
                </div>
              </div>

              {/* Mortgage */}
              <div className="section-card">
                <div className="section-header">
                  <div className="icon-wrapper">
                    <DollarSign size={20} />
                  </div>
                  <h2 className="section-title">Mortgage Information</h2>
                </div>
                <div style={{ maxWidth: '400px' }}>
                  <label className="label">Mortgage Amount</label>
                  <input
                    type="number"
                    className="input-field"
                    value={formData.mortgage}
                    onChange={(e) => handleInputChange('mortgage', parseFloat(e.target.value) || 0)}
                    placeholder="0.00"
                  />
                </div>
              </div>

              {/* Resorts */}
              <div className="section-card">
                <div className="section-header">
                  <div className="icon-wrapper">
                    <Building2 size={20} />
                  </div>
                  <h2 className="section-title">Resort Information</h2>
                </div>
                
                <div style={{ 
                  background: 'linear-gradient(135deg, #7c3aed 0%, #60a5fa 100%)',
                  borderRadius: '12px',
                  padding: '16px 20px',
                  marginBottom: '24px',
                  color: 'white'
                }}>
                  <div style={{ fontSize: '13px', fontWeight: '700', opacity: '0.9', marginBottom: '4px' }}>
                    Total Annual Maintenance / Taxes
                  </div>
                  <div style={{ fontSize: '28px', fontWeight: '800' }}>
                    ${formatCurrency(totalAnnualMaint)}
                  </div>
                </div>
                
                {formData.resorts.map((resort, index) => (
                  <div key={index} className={`resort-card ${resort.active ? 'active' : 'inactive'}`}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                      <h4 style={{ fontSize: '18px', fontWeight: '700', color: '#e2e8f0' }}>
                        Resort #{index + 1}
                      </h4>
                      <label style={{ display: 'flex', alignItems: 'center', gap: '12px', cursor: 'pointer' }}>
                        <span style={{ fontSize: '14px', fontWeight: '600', color: '#94a3b8' }}>
                          {resort.active ? 'Active' : 'Inactive'}
                        </span>
                        <div
                          className={`toggle-switch ${resort.active ? 'active' : ''}`}
                          onClick={() => handleResortChange(index, 'active', !resort.active)}
                        >
                          <div className="toggle-slider" />
                        </div>
                      </label>
                    </div>
                    
                    {resort.active && (
                      <div style={{ display: 'grid', gap: '16px' }}>
                        <div>
                          <label className="label">Resort Name *</label>
                          <input
                            type="text"
                            className="input-field"
                            value={resort.name}
                            onChange={(e) => handleResortChange(index, 'name', e.target.value)}
                            placeholder="e.g., Holiday Inn Club Vacations"
                          />
                        </div>
                        
                        <div className="grid-2">
                          <div>
                            <label className="label">Annual Maintenance / Taxes Fee *</label>
                            <input
                              type="number"
                              className="input-field"
                              value={resort.maintenanceFee}
                              onChange={(e) => handleResortChange(index, 'maintenanceFee', parseFloat(e.target.value) || 0)}
                              placeholder="2500.00"
                            />
                          </div>
                          <div>
                            <label className="label">Assumed Inflation Rate (%) *</label>
                            <input
                              type="number"
                              step="0.1"
                              className="input-field"
                              value={resort.inflationRate}
                              onChange={(e) => handleResortChange(index, 'inflationRate', parseFloat(e.target.value) || 0)}
                              placeholder="9.5"
                            />
                          </div>
                        </div>
                      </div>
                    )}
                  </div>
                ))}
              </div>

              {/* Drop Sheet Defaults */}
              <div className="section-card">
                <div className="section-header">
                  <div className="icon-wrapper">
                    <TrendingUp size={20} />
                  </div>
                  <h2 className="section-title">Drop Sheet Defaults</h2>
                </div>
                <div className="grid-3">
                  <div>
                    <label className="label">Transfer Fees</label>
                    <input
                      type="number"
                      className="input-field"
                      value={formData.transferFees}
                      onChange={(e) => handleInputChange('transferFees', parseFloat(e.target.value) || 0)}
                      placeholder="1800"
                    />
                  </div>
                  <div>
                    <label className="label">Processing Fee</label>
                    <input
                      type="number"
                      className="input-field"
                      value={formData.processingFee}
                      onChange={(e) => handleInputChange('processingFee', parseFloat(e.target.value) || 0)}
                      placeholder="449"
                    />
                  </div>
                  <div>
                    <label className="label">MRA Value</label>
                    <input
                      type="number"
                      className="input-field"
                      value={formData.mra}
                      onChange={(e) => handleInputChange('mra', parseFloat(e.target.value) || 0)}
                      placeholder="12500"
                    />
                  </div>
                </div>
              </div>

              {/* Continue Button */}
              <div style={{ display: 'flex', justifyContent: 'flex-end', marginTop: '24px' }}>
                <button
                  onClick={goToDropSheets}
                  className="btn-primary"
                  style={{ display: 'flex', alignItems: 'center', gap: '8px' }}
                  disabled={!formData.owner1Name || !activeResorts.some(r => r.maintenanceFee > 0)}
                >
                  Generate Drop Sheets
                  <ChevronRight size={20} />
                </button>
              </div>
            </div>
          </div>
        )}


        {/* STEP 2: Drop Sheets - PRINT OPTIMIZED */}
        {step === 2 && (
          <div className="fade-in">
            <div className="no-print glass-card" style={{ padding: '28px', marginBottom: '24px' }}>
              <h2 style={{ fontSize: '28px', fontWeight: '800', color: '#212529', marginBottom: '12px' }}>
                Drop Sheets
              </h2>
              <p style={{ color: '#6c757d', marginBottom: '20px', fontWeight: '500' }}>
                Review and edit values as needed, then print each drop sheet. Each sheet will print on separate pages.
              </p>
              <button
                onClick={() => setStep(1)}
                className="btn-secondary"
                style={{ display: 'inline-flex', alignItems: 'center', gap: '8px' }}
              >
                <ChevronLeft size={20} />
                Back to Input
              </button>
            </div>

            {dropSheetData.map((sheet, idx) => (
              <div key={idx}>
                {/* Container for PDF generation */}
                <div id={`drop-sheet-${idx}`}>
                {/* PAGE 1: Summary & Comparison */}
                <div className="print-page" style={{ background: 'white', padding: '20px', marginBottom: '20px', borderRadius: '12px' }}>
                  
                  {/* Header */}
                  <div className="print-header avoid-break" style={{ marginBottom: '20px' }}>
                    <h1 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '12px', color: '#000' }}>
                      TIMESHARE LIQUIDATION ANALYSIS
                    </h1>
                    <div className="print-info-grid">
                      <div><strong>Owner:</strong> {sheet.owner}</div>
                      <div><strong>Resort:</strong> {sheet.resortName}</div>
                      <div style={{ gridColumn: 'span 2', marginBottom: '15px' }}>
                        <strong>Inflation Rate:</strong> {sheet.inflationRate}%
                      </div>
                    </div>
                  </div>

                  {/* Two Column Comparison */}
                  <div className="comparison-grid avoid-break" style={{ gap: '20px' }}>
                    {/* Option 1: Current Contract */}
                    <div className="option-box" style={{ 
                      border: '3px solid #ef4444',
                      borderRadius: '8px',
                      padding: '16px',
                      background: '#fff'
                    }}>
                      <div className="option-header" style={{ 
                        background: '#fee2e2', 
                        padding: '12px', 
                        marginBottom: '12px',
                        borderLeft: '4px solid #ef4444',
                        borderRadius: '4px'
                      }}>
                        <h2 style={{ fontSize: '14px', fontWeight: 'bold', margin: 0, color: '#991b1b' }}>
                          Option 1: CURRENT CONTRACT
                        </h2>
                      </div>
                      <div style={{ fontSize: '11px', lineHeight: '1.6' }}>
                        <div style={{ marginBottom: '6px' }}>
                          <strong>Resort:</strong> {sheet.resortName}
                        </div>
                        <div style={{ marginBottom: '4px' }}>✗ Maintenance / Taxes Fees Inflation</div>
                        <div style={{ marginBottom: '4px' }}>✗ Tied to Owner's Estate</div>
                        <div style={{ marginBottom: '4px' }}>✗ Probate Liability</div>
                        <div style={{ marginBottom: '4px' }}>✗ Deeded Property</div>
                        <div style={{ marginBottom: '4px' }}>✗ External Exchange Fees</div>
                        <div style={{ marginBottom: '4px' }}>✗ Travel Demand Index Risk</div>
                        <div style={{ marginBottom: '4px' }}>✗ No Exit Strategy</div>
                        <div style={{ marginBottom: '6px', fontSize: '10px', color: '#666' }}>
                          Subject to House Bill 453 & 7025
                        </div>
                      </div>
                      
                      <div className="cost-box" style={{ 
                        marginTop: '12px', 
                        padding: '12px', 
                        background: '#fee2e2',
                        border: '2px solid #ef4444'
                      }}>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>Annual Maintenance / Taxes Fee:</strong>
                          <span>${formatCurrency(sheet.currentMaintFee)}</span>
                        </div>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>30-Year Inflation Total:</strong>
                          <span>${formatCurrency(sheet.maintFeeInflation)}</span>
                        </div>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>Mortgage Payoff:</strong>
                          <span>${formatCurrency(sheet.mortgage)}</span>
                        </div>
                        <div className="cost-total" style={{ 
                          paddingTop: '8px', 
                          borderTop: '2px solid #ef4444',
                          fontSize: '12px',
                          fontWeight: 'bold',
                          display: 'flex',
                          justifyContent: 'space-between'
                        }}>
                          <span>Total Cost of Ownership:</span>
                          <span>${formatCurrency(sheet.totalCost)}</span>
                        </div>
                      </div>
                    </div>

                    {/* Option 2: Liquidation */}
                    <div className="option-box" style={{ 
                      border: '3px solid #10b981',
                      borderRadius: '8px',
                      padding: '16px',
                      background: '#fff'
                    }}>
                      <div className="option-header" style={{ 
                        background: '#d1fae5', 
                        padding: '12px', 
                        marginBottom: '12px',
                        borderLeft: '4px solid #10b981',
                        borderRadius: '4px'
                      }}>
                        <h2 style={{ fontSize: '14px', fontWeight: 'bold', margin: 0, color: '#065f46' }}>
                          Option 2: LIQUIDATION/TERMINATION
                        </h2>
                      </div>
                      <div style={{ fontSize: '11px', lineHeight: '1.6' }}>
                        <div style={{ marginBottom: '4px' }}>✓ Deed Liquidation/Termination</div>
                        <div style={{ marginBottom: '4px' }}>✓ NO Maintenance / Taxes Fees</div>
                        <div style={{ marginBottom: '4px' }}>✓ NOT Tied to Owner's Estate</div>
                        <div style={{ marginBottom: '4px' }}>✓ Liability Protection</div>
                        <div style={{ marginBottom: '4px' }}>✓ HB 453 Release</div>
                        <div style={{ marginBottom: '4px' }}>✓ HB 7025 Release</div>
                      </div>
                      
                      <div className="cost-box" style={{ 
                        marginTop: '12px', 
                        padding: '12px', 
                        background: editingDropSheet === idx ? '#fef3c7' : '#d1fae5',
                        border: editingDropSheet === idx ? '2px solid #f59e0b' : '2px solid #10b981'
                      }}>
                        <div className="no-print" style={{ marginBottom: '12px', textAlign: 'right' }}>
                          <button
                            onClick={() => setEditingDropSheet(editingDropSheet === idx ? null : idx)}
                            style={{
                              background: editingDropSheet === idx ? '#f59e0b' : '#10b981',
                              color: 'white',
                              border: 'none',
                              padding: '6px 12px',
                              borderRadius: '6px',
                              cursor: 'pointer',
                              fontSize: '11px',
                              fontWeight: '600',
                              display: 'inline-flex',
                              alignItems: 'center',
                              gap: '4px'
                            }}
                          >
                            {editingDropSheet === idx ? (
                              <>
                                <Check size={14} />
                                Done
                              </>
                            ) : (
                              <>
                                <Edit2 size={14} />
                                Edit
                              </>
                            )}
                          </button>
                        </div>
                        
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>Cost of Liquidation:</strong>
                          <span>${formatCurrency(sheet.year20Cumulative)}</span>
                        </div>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>Transfer Fees:</strong>
                          {editingDropSheet === idx ? (
                            <input
                              type="number"
                              value={sheet.transferFees}
                              onChange={(e) => handleDropSheetEdit(idx, 'transferFees', e.target.value)}
                              style={{
                                width: '100px',
                                padding: '4px',
                                border: '1px solid #ccc',
                                borderRadius: '4px',
                                textAlign: 'right'
                              }}
                            />
                          ) : (
                            <span>${formatCurrency(sheet.transferFees)}</span>
                          )}
                        </div>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>Processing Fee:</strong>
                          {editingDropSheet === idx ? (
                            <input
                              type="number"
                              value={sheet.processingFee}
                              onChange={(e) => handleDropSheetEdit(idx, 'processingFee', e.target.value)}
                              style={{
                                width: '100px',
                                padding: '4px',
                                border: '1px solid #ccc',
                                borderRadius: '4px',
                                textAlign: 'right'
                              }}
                            />
                          ) : (
                            <span>${formatCurrency(sheet.processingFee)}</span>
                          )}
                        </div>
                        <div className="cost-row" style={{ 
                          display: 'flex', 
                          justifyContent: 'space-between', 
                          marginBottom: '8px',
                          paddingBottom: '8px',
                          borderBottom: '1px solid #999'
                        }}>
                          <strong>Gross Liquidation Price:</strong>
                          <span>${formatCurrency(sheet.grossLiquidation)}</span>
                        </div>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>EBOC:</strong>
                          <span>${formatCurrency(sheet.eboc)}</span>
                        </div>
                        <div className="cost-row" style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                          <strong>MRA:</strong>
                          {editingDropSheet === idx ? (
                            <input
                              type="number"
                              value={sheet.mra}
                              onChange={(e) => handleDropSheetEdit(idx, 'mra', e.target.value)}
                              style={{
                                width: '100px',
                                padding: '4px',
                                border: '1px solid #ccc',
                                borderRadius: '4px',
                                textAlign: 'right'
                              }}
                            />
                          ) : (
                            <span>${formatCurrency(sheet.mra)}</span>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* PAGE 2: 30-Year Projection Table */}
                <div className="print-page" style={{ background: 'white', padding: '20px', marginBottom: '20px', borderRadius: '12px' }}>
                  <h3 style={{ fontSize: '16px', fontWeight: 'bold', marginBottom: '12px', color: '#000' }}>
                    30-Year Maintenance / Taxes Fee Projection - {sheet.resortName}
                  </h3>
                  <table style={{ 
                    width: '100%', 
                    borderCollapse: 'collapse',
                    fontSize: '11px'
                  }}>
                    <thead>
                      <tr style={{ background: '#f3f4f6', borderBottom: '2px solid #000' }}>
                        <th style={{ padding: '8px', textAlign: 'left' }}>Year</th>
                        <th style={{ padding: '8px', textAlign: 'right' }}>Annual Cost</th>
                        <th style={{ padding: '8px', textAlign: 'right' }}>Cumulative Cost</th>
                      </tr>
                    </thead>
                    <tbody>
                      {sheet.projections.map((year) => (
                        <tr key={year.year} style={{ borderBottom: '1px solid #ddd' }}>
                          <td style={{ padding: '6px' }}>Year {year.year}</td>
                          <td style={{ padding: '6px', textAlign: 'right' }}>
                            ${formatCurrency(year.annualCost)}
                          </td>
                          <td style={{ padding: '6px', textAlign: 'right', fontWeight: 'bold' }}>
                            ${formatCurrency(year.cumulative)}
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                {/* PAGE 3: Signature Section */}
                <div className="print-page" style={{ background: 'white', padding: '20px', marginBottom: '20px', borderRadius: '12px' }}>
                  <div className="signature-section avoid-break">
                    <h3 style={{ fontSize: '14px', fontWeight: 'bold', marginBottom: '15px' }}>
                      OWNER ACKNOWLEDGMENT
                    </h3>
                    <div style={{ marginBottom: '25px' }}>
                      <p style={{ marginBottom: '12px', fontSize: '11px' }}>
                        The foregoing document was acknowledged before me this _____ day of _____________, 20____.
                      </p>
                      <div style={{ marginTop: '30px' }}>
                        <div style={{ display: 'inline-block', width: '45%', marginRight: '5%' }}>
                          <div className="signature-line" style={{ height: '30px' }}>&nbsp;</div>
                          <div style={{ fontSize: '10px' }}>Signature</div>
                        </div>
                        <div style={{ display: 'inline-block', width: '45%' }}>
                          <div className="signature-line" style={{ height: '30px' }}>&nbsp;</div>
                          <div style={{ fontSize: '10px' }}>Date</div>
                        </div>
                      </div>
                    </div>
                    
                    <div style={{ marginTop: '25px', fontSize: '11px' }}>
                      <div style={{ fontWeight: 'bold', marginBottom: '10px' }}>
                        Please initial your selection:
                      </div>
                      <div style={{ marginBottom: '8px', lineHeight: '1.6' }}>
                        OPTION 1 (Current Contract): _______ ACCEPT &nbsp;&nbsp; _______ DECLINE
                      </div>
                      <div style={{ lineHeight: '1.6' }}>
                        OPTION 2 (Liquidation): _______ ACCEPT &nbsp;&nbsp; _______ DECLINE
                      </div>
                    </div>
                  </div>
                </div>
                </div>
                {/* End PDF container */}

                {/* Print and Download Buttons */}
                <div className="no-print" style={{ marginBottom: '40px', textAlign: 'center' }}>
                  <div style={{ display: 'flex', gap: '16px', justifyContent: 'center', flexWrap: 'wrap', marginBottom: '12px' }}>
                    <button
                      onClick={() => printDropSheet(idx)}
                      className="btn-primary"
                      style={{ display: 'inline-flex', alignItems: 'center', gap: '10px' }}
                    >
                      <Printer size={20} />
                      Print {sheet.resortName}
                    </button>
                    <button
                      onClick={() => downloadDropSheet(idx)}
                      style={{ 
                        display: 'inline-flex', 
                        alignItems: 'center', 
                        gap: '10px',
                        background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
                        color: 'white',
                        padding: '16px 32px',
                        borderRadius: '16px',
                        border: 'none',
                        fontWeight: '700',
                        fontSize: '15px',
                        cursor: 'pointer',
                        boxShadow: '0 4px 16px rgba(16, 185, 129, 0.3)',
                        transition: 'all 0.3s ease'
                      }}
                      onMouseOver={(e) => {
                        e.currentTarget.style.transform = 'translateY(-2px)';
                        e.currentTarget.style.boxShadow = '0 8px 24px rgba(16, 185, 129, 0.4)';
                      }}
                      onMouseOut={(e) => {
                        e.currentTarget.style.transform = 'translateY(0)';
                        e.currentTarget.style.boxShadow = '0 4px 16px rgba(16, 185, 129, 0.3)';
                      }}
                    >
                      <Download size={20} />
                      Download PDF
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

ReactDOM.render(<TimeshareCalculator />, document.getElementById("root"));
  </script>
</body>
</html>
